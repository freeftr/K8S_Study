# Section09 CNI Weave

라우팅 테이블을 기반으로 Pod 네트워킹을 하면 수많은 pod가 있는 대규모 클러스터에서는 비효율적이다.

### Weave CNI
- CNI 기반 네트워크 플러그인
- 각 노드에 weave 에이전트를 배치하고 전체 Pod 네트워크 토폴로지를 공유.
- 노드별로 weave bridge를 생성하고, Pod에 IP를 할당.
- Pod간 통신을 weave가 처리하면, 라우트 설정.

### 동작 방식
1. Pod간 통신 시 패킷을 Weave 에이전트에 도달.
2. 대상 Pod가 다른 노드에 있으면 Weave가 패킷 캡슐화 진행
   - 새로운 소스/목적지 IP를 부여한 외부 패킷으로 변환.
3. 네트워크를 통해 대상 노드로 전송.
4. 대상 노드의 Weave 에이전트가 디캡슐화 후 원래 패킷을 꺼내 대상 Pod에 전달.

### 장점
- Pod간 IP 직접 통신 지원 => NAT 불필요
- 네트워크 토폴로지 자동 관리
- 크로스-노드 Pod 통신 보장

### 배포
- definition 파일로 DaemonSet 활용해서 배포